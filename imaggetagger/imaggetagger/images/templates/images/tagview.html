{% extends 'images/tagger_base.html' %}
{% load static %}
{% block individual_script %}
function init_navigationbuttons() {
{% if next_image %}
$('#next_button').click(function(){
$('#annotation_form').attr('action', '{% url 'images_tagview' next_image.id %}');
$('#annotation_form').submit();
});
$('#skip_button').click(function(){window.location.href="{% url 'images_tagview' next_image.id %}"});
{% else %}
$('#next_button').attr('disabled', 'true');
$('#skip_button').attr('disabled', 'true');
{% endif %}

{% if last_image %}
$('#last_button').click(function(){
$('#annotation_form').attr('action', '{% url 'images_tagview' last_image.id %}');
$('#annotation_form').submit();
});
$('#back_button').click(function(){window.location.href="{% url 'images_tagview' last_image.id %}"});
{% else %}
$('#last_button').attr('disabled', 'true');
$('#back_button').attr('disabled', 'true');
{% endif %}
}
{% endblock %}
{% block bodyblock %}
<div class="container">
    <div class="row">
        <div class="col-md-3">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <a href="{% url 'images_imagesetview' selected_image.image_set.id %}"><u><h3 class="panel-title">{{selected_image.image_set.name}}</h3></u></a>
                </div>
                <div class="panel-body">
                    {% for set_image in set_images %}
                    {% if set_image.id == selected_image.id %}
                    <b id="selected_image_row">{{set_image.name}}</b><br>
                    {% else %}
                    <a href="{% url 'images_tagview' set_image.id %}"> {{set_image.name}}</a><br>
                    {% endif %}
                    {% endfor %}
                </div>
            </div>
        </div>
        <div class="col-md-5">
            <img id="picture" src="{% url 'images_imageview' selected_image.id %}" alt="Picture {{selected_image.name}} not found!" width="100%"></br>
            <hr color="silver" width="100%">
            {% if image_annotations.all %}
            <u>Annotations:</u>
            {% for annotation in image_annotations %}
            <div class="annotation">
                {{annotation.type.name}}:
                <div style="float: right;">
                    <a href="{% url 'images_verifyview' annotation.id%}">
                        <img src="{% static "symbols/checkmark.png" %}" alt="edit">
                    </a>
                    <a href="{% url 'images_tageditview' annotation.id%}">
                        <img src="{% static "symbols/pencil.png" %}" alt="edit">
                    </a>
                    <a href="{% url 'images_tagdeleteview' annotation.id%}">
                        <img src="{% static "symbols/bin.png" %}" alt="delete">
                    </a>
                </div>
                <br>
                {{annotation.content}}
            </div>
            {% endfor %}
            {% else %}
            <div class="alert alert-warning" role="alert">No annotations found.</div>
            {% endif %}
        </div>
        <div class="col-md-4">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">{{selected_image.name}}</h3>
                </div>
                <div class="panel-body">
                    <form id="annotation_form" action="{% url 'images_tagview' selected_image.id %}" enctype="multipart/form-data" method="post">
                        {% csrf_token %}
                        <input type="hidden" name="image_id" value="{{ selected_image.id }}">
                        annotation type:
                        <select name="selected_annotation_type">
                            {% for annotation_type in annotation_types %}
                            <option value="{{annotation_type.id}}"  {% if annotation_type.id == last_annotation_type_id %} selected {% endif %} >
                                {{annotation_type.name}}
                            </option>
                            {% endfor %}
                        </select>
                        <table border="1">
                            <tr>
                                <td>key</td>
                                <td>value</td>
                            </tr>
                            <tr>
                                <td>x1</td>
                                <td><input id="x1Field" class="Coordinates" type="number" name="x1Field" value="0" min="0"></td>
                            </tr>
                            <tr>
                                <td>y1</td>
                                <td><input id="y1Field" class="Coordinates" type="number" name="y1Field" value="0" min="0"></td>
                            </tr>
                            <tr>
                                <td>x2</td>
                                <td><input id="x2Field" class="Coordinates" type="number" name="x2Field" value="0" min="0"></td>
                            </tr>
                            <tr>
                                <td>y2</td>
                                <td><input id="y2Field" class="Coordinates" type="number" name="y2Field" value="0" min="0"></td>
                            </tr>
                            <tr>
                                <td colspan='2'><input type='checkbox' name='not_in_image' id='not_in_image'><label for='not_in_image'>Not in the image</label></td>
                            </tr>
                        </table>
                        <button type="submit" class="btn btn-default">
                            <span class="glyphicon glyphicon-floppy-save" aria-hidden="true"></span>Save (space)
                        </button>
                        <button class="btn btn-default" id="reset_button" onclick="reset_selection()">
                            <span class="glyphicon glyphicon-erase" aria-hidden="true"></span>Reset (r)
                        </button>
                        <br>
                        <button class="btn btn-default" id="last_button">
                            <span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="glyphicon glyphicon-floppy-save" aria-hidden="true"></span>Last (a)
                        </button>
                        <button class="btn btn-default" id="back_button">
                            <span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span>Back (s)
                        </button>
                        <br>
                        <button class="btn btn-default" id="skip_button">
                            <span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span>Skip (d)
                        </button>
                        <button class="btn btn-default" id="next_button">
                            <span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="glyphicon glyphicon-floppy-save" aria-hidden="true"></span>Next (f)
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}

